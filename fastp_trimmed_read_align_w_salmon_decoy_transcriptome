#####Create decoy-aware transcriptome per https://combine-lab.github.io/alevin-tutorial/2019/selective-alignment/
###Salmon documentation https://salmon.readthedocs.io/en/latest/salmon.html

# 1. --- Make a decoy transcriptome ---

#genome source:
https://ftp.ensembl.org/pub/**release-102**/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz

#transcriptome source: 
ftp://ftp.ensembl.org/pub/**release-102**/fasta/homo_sapiens/cdna/Homo_sapiens.GRCh38.cdna.all.fa.gz


grep "^>" <(Homo_sapiens.GRCh38.102.dna.primary_assembly.fa.gz ) | cut -d " " -f 1 > decoys.txt
sed -i.bak -e 's/>//g' decoys.txt
cat Homo_sapiens.GRCh38.102.cdna.all.fa.gz Homo_sapiens.GRCh38.102.dna.primary_assembly.fa.gz  > gentrome.fa.gz


# 2. --- Index decoy transcriptome ---

salmon index \
  -t /your/gentrome.fa.gz \
  -d decoys.txt \
  -i salmon_index_decoy \
  -k 31 \
